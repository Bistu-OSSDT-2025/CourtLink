@echo off
chcp 65001 >nul
title CourtLink åœºåœ°é¢„çº¦ç³»ç»Ÿ - å¸è½½ç¨‹åº
color 0E

echo.
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                                                                            â•‘
echo â•‘                    ðŸ“ CourtLink å¸è½½ç¨‹åº ðŸ“                               â•‘
echo â•‘                                                                            â•‘
echo â•‘                           ç§»é™¤ç³»ç»Ÿå¿«æ·æ–¹å¼                                 â•‘
echo â•‘                                                                            â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

set "DESKTOP_DIR=%USERPROFILE%\Desktop"
set "START_MENU_DIR=%APPDATA%\Microsoft\Windows\Start Menu\Programs\CourtLink"
set "SHORTCUT_NAME=CourtLink åœºåœ°é¢„çº¦ç³»ç»Ÿ"

echo âš ï¸ è­¦å‘Šï¼šæ­¤æ“ä½œå°†å®Œå…¨å¸è½½ CourtLink åœºåœ°é¢„çº¦ç³»ç»Ÿ
echo.
echo ðŸ“‹ å¸è½½å†…å®¹ï¼š
echo    â”œâ”€ æ¡Œé¢å¿«æ·æ–¹å¼
echo    â”œâ”€ å¼€å§‹èœå•å¿«æ·æ–¹å¼
echo    â”œâ”€ å…³é—­è¿è¡Œä¸­çš„æœåŠ¡
echo    â””â”€ æ¸…ç†ä¸´æ—¶æ–‡ä»¶
echo.
echo ðŸ’¡ æ³¨æ„ï¼šé¡¹ç›®æ–‡ä»¶å’Œæ•°æ®åº“ä¸ä¼šè¢«åˆ é™¤
echo.
set /p "confirm=ç¡®å®šè¦å¸è½½å—ï¼Ÿ(Y/N): "
if /i not "%confirm%"=="Y" (
    echo å–æ¶ˆå¸è½½
    pause
    exit /b 0
)

echo.
echo ðŸ”§ å¼€å§‹å¸è½½...
echo.

:: å…ˆå…³é—­æ‰€æœ‰æœåŠ¡
echo [1/5] å…³é—­è¿è¡Œä¸­çš„æœåŠ¡...
echo ðŸ›‘ æ­£åœ¨å…³é—­åŽç«¯æœåŠ¡...
taskkill /f /im "java.exe" >nul 2>&1
echo ðŸ›‘ æ­£åœ¨å…³é—­å‰ç«¯æœåŠ¡...
taskkill /f /im "node.exe" >nul 2>&1
echo ðŸ›‘ æ­£åœ¨å…³é—­å¯åŠ¨å™¨çª—å£...
taskkill /f /fi "WINDOWTITLE eq CourtLink-Backend*" >nul 2>&1
taskkill /f /fi "WINDOWTITLE eq CourtLink-Frontend*" >nul 2>&1
echo âœ… æœåŠ¡å…³é—­å®Œæˆ

:: åˆ é™¤æ¡Œé¢å¿«æ·æ–¹å¼
echo [2/5] åˆ é™¤æ¡Œé¢å¿«æ·æ–¹å¼...
if exist "%DESKTOP_DIR%\%SHORTCUT_NAME%.lnk" (
    del "%DESKTOP_DIR%\%SHORTCUT_NAME%.lnk" >nul 2>&1
    echo âœ… æ¡Œé¢å¿«æ·æ–¹å¼å·²åˆ é™¤
) else (
    echo âœ… æœªå‘çŽ°æ¡Œé¢å¿«æ·æ–¹å¼
)

:: åˆ é™¤å¼€å§‹èœå•å¿«æ·æ–¹å¼
echo [3/5] åˆ é™¤å¼€å§‹èœå•å¿«æ·æ–¹å¼...
if exist "%START_MENU_DIR%" (
    rmdir /s /q "%START_MENU_DIR%" >nul 2>&1
    echo âœ… å¼€å§‹èœå•å¿«æ·æ–¹å¼å·²åˆ é™¤
) else (
    echo âœ… æœªå‘çŽ°å¼€å§‹èœå•å¿«æ·æ–¹å¼
)

:: æ¸…ç†ä¸´æ—¶æ–‡ä»¶
echo [4/5] æ¸…ç†ä¸´æ—¶æ–‡ä»¶...
if exist "data\*.trace.db" (
    del "data\*.trace.db" >nul 2>&1
    echo âœ… æ¸…ç†æ•°æ®åº“ä¸´æ—¶æ–‡ä»¶
)
if exist "target\*.tmp" (
    del "target\*.tmp" >nul 2>&1
    echo âœ… æ¸…ç†æž„å»ºä¸´æ—¶æ–‡ä»¶
)
if exist "frontend\dist\*.tmp" (
    del "frontend\dist\*.tmp" >nul 2>&1
    echo âœ… æ¸…ç†å‰ç«¯ä¸´æ—¶æ–‡ä»¶
)
if exist "logs\*.tmp" (
    del "logs\*.tmp" >nul 2>&1
    echo âœ… æ¸…ç†æ—¥å¿—ä¸´æ—¶æ–‡ä»¶
)
echo âœ… ä¸´æ—¶æ–‡ä»¶æ¸…ç†å®Œæˆ

:: æ¸…ç†æ³¨å†Œè¡¨ï¼ˆå¦‚æžœæœ‰çš„è¯ï¼‰
echo [5/5] æ¸…ç†ç³»ç»Ÿæ³¨å†Œä¿¡æ¯...
:: è¿™é‡Œå¯ä»¥æ·»åŠ æ¸…ç†æ³¨å†Œè¡¨çš„ä»£ç ï¼ˆå¦‚æžœéœ€è¦ï¼‰
echo âœ… ç³»ç»Ÿæ³¨å†Œä¿¡æ¯æ¸…ç†å®Œæˆ

echo.
echo ðŸŽ‰ å¸è½½å®Œæˆï¼
echo.
echo ðŸ“Š å¸è½½ç»“æžœï¼š
echo    â”œâ”€ æ¡Œé¢å¿«æ·æ–¹å¼ï¼šå·²åˆ é™¤
echo    â”œâ”€ å¼€å§‹èœå•å¿«æ·æ–¹å¼ï¼šå·²åˆ é™¤
echo    â”œâ”€ è¿è¡Œä¸­çš„æœåŠ¡ï¼šå·²å…³é—­
echo    â””â”€ ä¸´æ—¶æ–‡ä»¶ï¼šå·²æ¸…ç†
echo.
echo ðŸ’¡ ä¿ç•™çš„å†…å®¹ï¼š
echo    â€¢ é¡¹ç›®æºä»£ç æ–‡ä»¶
echo    â€¢ æ•°æ®åº“æ–‡ä»¶ï¼ˆç”¨æˆ·æ•°æ®ï¼‰
echo    â€¢ æ—¥å¿—æ–‡ä»¶
echo    â€¢ é…ç½®æ–‡ä»¶
echo.
echo ðŸ“ å¦‚éœ€å®Œå…¨åˆ é™¤ï¼š
echo    â€¢ è¯·æ‰‹åŠ¨åˆ é™¤é¡¹ç›®æ–‡ä»¶å¤¹
echo    â€¢ æ•°æ®åº“æ–‡ä»¶ä½äºŽï¼šdata\courtlink.mv.db
echo    â€¢ æ—¥å¿—æ–‡ä»¶ä½äºŽï¼šlogs\ æ–‡ä»¶å¤¹
echo.
echo ðŸ”„ é‡æ–°å®‰è£…ï¼š
echo    â€¢ è¿è¡Œ"æ¡Œé¢å®‰è£….bat"å³å¯é‡æ–°å®‰è£…
echo.
echo æ„Ÿè°¢ä½¿ç”¨ CourtLink åœºåœ°é¢„çº¦ç³»ç»Ÿï¼
echo.
echo æŒ‰ä»»æ„é”®é€€å‡º...
pause >nul 
@echo off
chcp 65001 >nul
title CourtLink åœºåœ°é¢„çº¦ç³»ç»Ÿ - å…³é—­ç¨‹åº
color 0C

echo.
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                                                                            â•‘
echo â•‘                    ðŸ“ CourtLink ç³»ç»Ÿå…³é—­ç¨‹åº ðŸ“                           â•‘
echo â•‘                                                                            â•‘
echo â•‘                           å®‰å…¨å…³é—­æ‰€æœ‰æœåŠ¡                                 â•‘
echo â•‘                                                                            â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

echo ðŸ” æ­£åœ¨æ£€æŸ¥è¿è¡Œçš„æœåŠ¡...
echo.

:: æ£€æŸ¥Javaè¿›ç¨‹ï¼ˆåŽç«¯æœåŠ¡ï¼‰
echo [1/4] æ£€æŸ¥åŽç«¯æœåŠ¡...
tasklist | findstr /i "java.exe" >nul 2>&1
if %errorlevel% == 0 (
    echo ðŸ“¦ å‘çŽ°åŽç«¯æœåŠ¡æ­£åœ¨è¿è¡Œ
    echo ðŸ›‘ æ­£åœ¨å…³é—­åŽç«¯æœåŠ¡...
    taskkill /f /im "java.exe" >nul 2>&1
    if %errorlevel% == 0 (
        echo âœ… åŽç«¯æœåŠ¡å·²å…³é—­
    ) else (
        echo âš ï¸ åŽç«¯æœåŠ¡å…³é—­å¤±è´¥ï¼Œå¯èƒ½éœ€è¦æ‰‹åŠ¨å…³é—­
    )
) else (
    echo âœ… æœªå‘çŽ°åŽç«¯æœåŠ¡
)

:: æ£€æŸ¥Node.jsè¿›ç¨‹ï¼ˆå‰ç«¯æœåŠ¡ï¼‰
echo [2/4] æ£€æŸ¥å‰ç«¯æœåŠ¡...
tasklist | findstr /i "node.exe" >nul 2>&1
if %errorlevel% == 0 (
    echo ðŸ“¦ å‘çŽ°å‰ç«¯æœåŠ¡æ­£åœ¨è¿è¡Œ
    echo ðŸ›‘ æ­£åœ¨å…³é—­å‰ç«¯æœåŠ¡...
    taskkill /f /im "node.exe" >nul 2>&1
    if %errorlevel% == 0 (
        echo âœ… å‰ç«¯æœåŠ¡å·²å…³é—­
    ) else (
        echo âš ï¸ å‰ç«¯æœåŠ¡å…³é—­å¤±è´¥ï¼Œå¯èƒ½éœ€è¦æ‰‹åŠ¨å…³é—­
    )
) else (
    echo âœ… æœªå‘çŽ°å‰ç«¯æœåŠ¡
)

:: æ£€æŸ¥CMDçª—å£ï¼ˆå¯åŠ¨å™¨ç›¸å…³ï¼‰
echo [3/4] æ£€æŸ¥å¯åŠ¨å™¨çª—å£...
tasklist | findstr /i "cmd.exe" >nul 2>&1
if %errorlevel% == 0 (
    echo ðŸ“¦ å‘çŽ°å¯åŠ¨å™¨ç›¸å…³çª—å£
    echo ðŸ›‘ æ­£åœ¨å…³é—­ç›¸å…³çª—å£...
    :: åªå…³é—­å¸¦æœ‰ç‰¹å®šæ ‡é¢˜çš„çª—å£
    taskkill /f /fi "WINDOWTITLE eq CourtLink-Backend*" >nul 2>&1
    taskkill /f /fi "WINDOWTITLE eq CourtLink-Frontend*" >nul 2>&1
    echo âœ… å¯åŠ¨å™¨çª—å£å·²å…³é—­
) else (
    echo âœ… æœªå‘çŽ°å¯åŠ¨å™¨çª—å£
)

:: æ¸…ç†ä¸´æ—¶æ–‡ä»¶
echo [4/4] æ¸…ç†ä¸´æ—¶æ–‡ä»¶...
if exist "data\*.trace.db" (
    del "data\*.trace.db" >nul 2>&1
    echo âœ… æ¸…ç†æ•°æ®åº“ä¸´æ—¶æ–‡ä»¶
)
if exist "target\*.tmp" (
    del "target\*.tmp" >nul 2>&1
    echo âœ… æ¸…ç†æž„å»ºä¸´æ—¶æ–‡ä»¶
)
if exist "frontend\dist\*.tmp" (
    del "frontend\dist\*.tmp" >nul 2>&1
    echo âœ… æ¸…ç†å‰ç«¯ä¸´æ—¶æ–‡ä»¶
)
echo âœ… ä¸´æ—¶æ–‡ä»¶æ¸…ç†å®Œæˆ

echo.
echo ðŸŽ¯ å…³é—­æ“ä½œå®Œæˆï¼
echo.
echo ðŸ“Š ç³»ç»ŸçŠ¶æ€ï¼š
echo    â”œâ”€ åŽç«¯æœåŠ¡ï¼šå·²åœæ­¢
echo    â”œâ”€ å‰ç«¯æœåŠ¡ï¼šå·²åœæ­¢
echo    â”œâ”€ æ•°æ®åº“ï¼šå·²å…³é—­
echo    â””â”€ ä¸´æ—¶æ–‡ä»¶ï¼šå·²æ¸…ç†
echo.
echo ðŸ’¡ æç¤ºï¼š
echo    â€¢ æ‰€æœ‰æœåŠ¡å·²å®‰å…¨å…³é—­
echo    â€¢ æ•°æ®å·²è‡ªåŠ¨ä¿å­˜åˆ°æ•°æ®åº“
echo    â€¢ ä¸‹æ¬¡å¯åŠ¨è¯·ä½¿ç”¨æ¡Œé¢å¿«æ·æ–¹å¼
echo.
echo ðŸ”„ å¦‚éœ€é‡æ–°å¯åŠ¨ï¼Œè¯·ï¼š
echo    â€¢ åŒå‡»æ¡Œé¢"CourtLink åœºåœ°é¢„çº¦ç³»ç»Ÿ"å›¾æ ‡
echo    â€¢ æˆ–è¿è¡Œ"CourtLink-å¯åŠ¨å™¨.bat"
echo.
echo æŒ‰ä»»æ„é”®é€€å‡º...
pause >nul 